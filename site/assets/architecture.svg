<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="900" viewBox="0 0 1200 900" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .layer-bg { rx: 8; ry: 8; }
      .component { rx: 6; ry: 6; }
      .title { font-family: 'Inter', 'Segoe UI', Arial, sans-serif; font-weight: 700; }
      .subtitle { font-family: 'Inter', 'Segoe UI', Arial, sans-serif; font-weight: 500; }
      .label { font-family: 'Inter', 'Segoe UI', Arial, sans-serif; font-weight: 500; font-size: 12px; }
      .small-label { font-family: 'Inter', 'Segoe UI', Arial, sans-serif; font-weight: 400; font-size: 10px; }
      .arrow { stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .dashed-arrow { stroke-width: 1.5; fill: none; stroke-dasharray: 4,4; marker-end: url(#arrowhead-gray); }
      .external-bg { rx: 4; ry: 4; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1"/>
    </marker>
    <marker id="arrowhead-gray" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#cbd5e1"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1200" height="900" fill="#f8fafc"/>

  <!-- Title Section -->
  <text x="600" y="35" text-anchor="middle" class="title" font-size="28" fill="#1e293b">DeterminAgent Architecture</text>
  <text x="600" y="58" text-anchor="middle" class="subtitle" font-size="13" fill="#64748b">CLI-First Deterministic Multi-Agent Orchestration Library</text>

  <!-- ==================== LAYER 1: TEMPLATE FLOWS ==================== -->
  <rect x="30" y="80" width="1140" height="130" class="layer-bg" fill="#e0e7ff" stroke="#818cf8" stroke-width="2"/>
  <text x="50" y="108" class="title" font-size="16" fill="#4338ca">üìÅ Layer 1: Template Flows</text>
  <text x="1150" y="108" text-anchor="end" class="small-label" fill="#6366f1">Pre-built Python scripts for common use cases</text>

  <!-- Flow components -->
  <rect x="60" y="130" width="130" height="60" class="component" fill="#c7d2fe" stroke="#818cf8" stroke-width="1.5"/>
  <text x="125" y="155" text-anchor="middle" class="label" fill="#3730a3">flows/blog</text>
  <text x="125" y="171" text-anchor="middle" class="small-label" fill="#6366f1">Writer ‚Üí Editor</text>
  <text x="125" y="183" text-anchor="middle" class="small-label" fill="#6366f1">‚Üí Reviewer</text>

  <rect x="210" y="130" width="130" height="60" class="component" fill="#c7d2fe" stroke="#818cf8" stroke-width="1.5"/>
  <text x="275" y="155" text-anchor="middle" class="label" fill="#3730a3">flows/custom</text>
  <text x="275" y="171" text-anchor="middle" class="small-label" fill="#6366f1">User-defined</text>
  <text x="275" y="183" text-anchor="middle" class="small-label" fill="#6366f1">workflows</text>

  <text x="500" y="160" text-anchor="start" class="small-label" fill="#4338ca">Copy, customize, and run directly in Python</text>
  <text x="500" y="176" text-anchor="start" class="small-label" fill="#6366f1">No YAML DSL required for orchestration logic</text>

  <!-- ==================== LAYER 2: CONFIGURATION LAYER ==================== -->
  <rect x="30" y="230" width="1140" height="110" class="layer-bg" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="50" y="258" class="title" font-size="16" fill="#b45309">‚öôÔ∏è Layer 2: Configuration Layer</text>
  <text x="1150" y="258" text-anchor="end" class="small-label" fill="#d97706">Agent settings &amp; provider config</text>

  <rect x="60" y="280" width="150" height="50" class="component" fill="#fde68a" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="135" y="305" text-anchor="middle" class="label" fill="#92400e">YAML Config</text>
  <text x="135" y="321" text-anchor="middle" class="small-label" fill="#b45309">agent.yaml</text>

  <rect x="230" y="280" width="150" height="50" class="component" fill="#fde68a" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="305" y="305" text-anchor="middle" class="label" fill="#92400e">load_config()</text>
  <text x="305" y="321" text-anchor="middle" class="small-label" fill="#b45309">Auto-discovery</text>

  <text x="500" y="305" text-anchor="start" class="small-label" fill="#b45309">Provider selection, model aliases, permissions</text>
  <text x="500" y="321" text-anchor="start" class="small-label" fill="#b45309">System prompts, web search settings</text>

  <!-- ==================== LAYER 3: CORE LIBRARY ==================== -->
  <rect x="30" y="370" width="1140" height="500" class="layer-bg" fill="#dcfce7" stroke="#22c55e" stroke-width="2"/>
  <text x="50" y="398" class="title" font-size="16" fill="#15803d">üîß Layer 3: Core Library</text>
  <text x="1150" y="398" text-anchor="end" class="small-label" fill="#22c55e">Foundation: UnifiedAgent &amp; adapters</text>

  <!-- Main UnifiedAgent Component -->
  <rect x="350" y="420" width="500" height="80" class="component" fill="#86efac" stroke="#22c55e" stroke-width="2.5"/>
  <text x="600" y="447" text-anchor="middle" class="title" font-size="15" fill="#14532d">UnifiedAgent</text>
  <text x="600" y="465" text-anchor="middle" class="small-label" fill="#15803d">send(prompt) | send_structured(prompt, schema) | get_history() | clear_session()</text>
  <text x="600" y="479" text-anchor="middle" class="small-label" fill="#15803d">Main orchestration interface - abstracts provider details</text>

  <!-- Provider Adapters Row -->
  <text x="50" y="532" class="subtitle" font-size="12" fill="#15803d">Provider Adapters (CLI wrappers):</text>

  <rect x="50" y="550" width="110" height="70" class="component" fill="#bbf7d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="105" y="575" text-anchor="middle" class="label" fill="#15803d">Claude</text>
  <text x="105" y="590" text-anchor="middle" class="small-label" fill="#15803d">--session-id</text>
  <text x="105" y="603" text-anchor="middle" class="small-label" fill="#15803d">--system-prompt</text>

  <rect x="180" y="550" width="110" height="70" class="component" fill="#bbf7d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="235" y="575" text-anchor="middle" class="label" fill="#15803d">copilot</text>
  <text x="235" y="590" text-anchor="middle" class="small-label" fill="#15803d">--resume</text>
  <text x="235" y="603" text-anchor="middle" class="small-label" fill="#15803d">--continue</text>

  <rect x="310" y="550" width="110" height="70" class="component" fill="#bbf7d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="365" y="575" text-anchor="middle" class="label" fill="#15803d">Gemini</text>
  <text x="365" y="590" text-anchor="middle" class="small-label" fill="#15803d">--resume</text>
  <text x="365" y="603" text-anchor="middle" class="small-label" fill="#15803d">(via subagents)</text>

  <rect x="440" y="550" width="110" height="70" class="component" fill="#bbf7d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="495" y="575" text-anchor="middle" class="label" fill="#15803d">Codex</text>
  <text x="495" y="590" text-anchor="middle" class="small-label" fill="#15803d">exec</text>
  <text x="495" y="603" text-anchor="middle" class="small-label" fill="#15803d">exec resume</text>

  <!-- Supporting Components Row -->
  <text x="50" y="650" class="subtitle" font-size="12" fill="#15803d">Supporting Components:</text>

  <rect x="50" y="668" width="140" height="70" class="component" fill="#a7f3d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="120" y="693" text-anchor="middle" class="label" fill="#15803d">SessionManager</text>
  <text x="120" y="709" text-anchor="middle" class="small-label" fill="#15803d">Conversation history</text>
  <text x="120" y="722" text-anchor="middle" class="small-label" fill="#15803d">State tracking</text>

  <rect x="210" y="668" width="140" height="70" class="component" fill="#a7f3d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="280" y="693" text-anchor="middle" class="label" fill="#15803d">Parsers</text>
  <text x="280" y="709" text-anchor="middle" class="small-label" fill="#15803d">JSON/text output</text>
  <text x="280" y="722" text-anchor="middle" class="small-label" fill="#15803d">parsing &amp; validation</text>

  <rect x="370" y="668" width="140" height="70" class="component" fill="#a7f3d0" stroke="#22c55e" stroke-width="1.5"/>
  <text x="440" y="693" text-anchor="middle" class="label" fill="#15803d">Exceptions</text>
  <text x="440" y="709" text-anchor="middle" class="small-label" fill="#15803d">Typed error handling</text>
  <text x="440" y="722" text-anchor="middle" class="small-label" fill="#15803d">Retries &amp; recovery</text>

  <!-- Data Flow Description -->
  <rect x="550" y="668" width="600" height="70" class="external-bg" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="560" y="688" class="label" fill="#475569">Data Flow:</text>
  <text x="560" y="704" class="small-label" fill="#64748b">User prompt ‚Üí UnifiedAgent ‚Üí Adapter ‚Üí subprocess ‚Üí CLI tool ‚Üí stdout parse ‚Üí result</text>
  <text x="560" y="720" class="small-label" fill="#64748b">Session state managed by SessionManager with native CLI session flags</text>

  <!-- ==================== EXTERNAL SYSTEMS ==================== -->
  <text x="50" y="785" class="subtitle" font-size="12" fill="#475569">External CLI Tools (subprocess):</text>

  <rect x="50" y="805" width="100" height="50" class="external-bg" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="100" y="827" text-anchor="middle" class="label" fill="#64748b">claude CLI</text>
  <text x="100" y="842" text-anchor="middle" class="small-label" fill="#94a3b8">Local subprocess</text>

  <rect x="170" y="805" width="100" height="50" class="external-bg" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="220" y="827" text-anchor="middle" class="label" fill="#64748b">copilot</text>
  <text x="220" y="842" text-anchor="middle" class="small-label" fill="#94a3b8">Local subprocess</text>

  <rect x="290" y="805" width="100" height="50" class="external-bg" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="340" y="827" text-anchor="middle" class="label" fill="#64748b">gemini CLI</text>
  <text x="340" y="842" text-anchor="middle" class="small-label" fill="#94a3b8">Local subprocess</text>

  <rect x="410" y="805" width="100" height="50" class="external-bg" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1.5"/>
  <text x="460" y="827" text-anchor="middle" class="label" fill="#64748b">codex CLI</text>
  <text x="460" y="842" text-anchor="middle" class="small-label" fill="#94a3b8">Local subprocess</text>

  <!-- Key Benefits Box -->
  <rect x="550" y="805" width="620" height="50" class="external-bg" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5"/>
  <text x="560" y="825" class="small-label" fill="#15803d">‚úì Zero-latency control via subprocess  ‚úì Uses flat-rate CLI subscriptions  ‚úì Deterministic state management with LangGraph</text>
  <text x="560" y="843" class="small-label" fill="#15803d">‚úì Type-safe: Pydantic models throughout  ‚úì Testable: Mock-friendly design</text>

  <!-- ==================== ARROWS / DATA FLOW ==================== -->

  <!-- Layer transitions -->
  <path d="M600 210 L600 230" class="arrow" stroke="#6366f1"/>
  <path d="M600 340 L600 370" class="arrow" stroke="#6366f1"/>

  <!-- Config to UnifiedAgent -->
  <path d="M380 330 L500 420" class="dashed-arrow" stroke="#f59e0b"/>

  <!-- UnifiedAgent to Adapters -->
  <path d="M420 500 L105 550" class="arrow" stroke="#22c55e"/>
  <path d="M460 500 L235 550" class="arrow" stroke="#22c55e"/>
  <path d="M500 500 L365 550" class="arrow" stroke="#22c55e"/>
  <path d="M540 500 L495 550" class="arrow" stroke="#22c55e"/>

  <!-- Adapters to Supporting Components -->
  <path d="M105 620 L120 668" class="arrow" stroke="#22c55e"/>
  <path d="M235 620 L280 668" class="arrow" stroke="#22c55e"/>
  <path d="M365 620 L440 668" class="arrow" stroke="#22c55e"/>

  <!-- Supporting to External -->
  <path d="M100 738 L100 805" class="dashed-arrow" stroke="#cbd5e1"/>
  <path d="M220 738 L220 805" class="dashed-arrow" stroke="#cbd5e1"/>
  <path d="M340 738 L340 805" class="dashed-arrow" stroke="#cbd5e1"/>
  <path d="M460 738 L460 805" class="dashed-arrow" stroke="#cbd5e1"/>
</svg>
