# Blog Flow Configuration
# This file defines defaults and settings for the blog workflow.
# All values can be overridden via CLI arguments or environment variables.

name: "Blog Post Generator"
version: "1.0"

# =============================================================================
# Word Count Settings
# =============================================================================
word_count:
  min: 800
  max: 1200

# =============================================================================
# Default Providers and Models per Role
# =============================================================================
defaults:
  writer:
    provider: claude
    model: balanced
  editor:
    provider: claude
    model: fast
  reviewer:
    provider: claude
    model: powerful

# =============================================================================
# Review Settings
# =============================================================================
review:
  # Minimum score (1-10) for approval in each category
  min_score: 8
  # Maximum revision attempts before human intervention
  max_revisions: 3
  
  # Categories to evaluate (all must score >= min_score for approval)
  categories:
    - STRUCTURE
    - GRAMMAR
    - TECHNICAL_ACCURACY
    - ENGAGEMENT
    - ACTIONABILITY
    - SEO
    - FORMATTING
    - DEPTH
    - ORIGINALITY
    - WORD_COUNT
    - TITLE
    - INTRO

# =============================================================================
# Prompt Templates
# =============================================================================
prompts:
  writer_system: |
    YOUR ROLE: Professional Blog Writer

    EXPERTISE:
    - Technical content with engaging, accessible style
    - SEO-optimized structure
    - Clear, actionable insights
    - Compelling storytelling

    CORE PRINCIPLES:
    1. Start strong (hook the reader immediately)
    2. Use AIDA formula (Attention, Interest, Desire, Action)
    3. Include practical examples and code snippets
    4. End with clear next steps
    5. Optimize for both humans and search engines

  writer_task: |
    ASSIGNMENT: Write a comprehensive blog post

    TOPIC: {topic}

    WORD COUNT: {min_words}-{max_words} words

    STRUCTURE REQUIREMENTS:

    1. TITLE (10 words max)
       - Use power words (e.g., "Ultimate", "Essential", "Complete")
       - Create curiosity or urgency
       - Include target keyword

    2. INTRODUCTION (150-200 words)
       - Hook: Surprising fact, question, or bold statement
       - Problem: What pain point does this solve?
       - Promise: What will the reader learn?
       - Preview: Outline main sections

    3. BODY (3-5 main sections)
       - Each section: Clear H2 heading
       - Logical progression (beginner â†’ advanced)
       - Code examples with syntax highlighting
       - Real-world use cases
       - Common pitfalls and solutions

    4. CONCLUSION (100-150 words)
       - Summarize key takeaways
       - Call to action (try it, share it, comment)
       - Next steps or resources

    WRITING STYLE:
    - Conversational but professional
    - Use "you" to address reader directly
    - Short paragraphs (3-4 sentences max)
    - Active voice
    - Concrete examples over abstract concepts

    SEO OPTIMIZATION:
    - Target keyword in title, H2s, and first paragraph
    - LSI keywords throughout
    - Meta description potential in first 160 characters
    - Internal linking opportunities (mention related topics)

    OUTPUT: Complete blog post in Markdown format.

    CRITICAL OUTPUT RULES:
    1. Start DIRECTLY with the blog post title (e.g., "# Title Here").
    2. Do NOT include ANY introductory text (e.g., "I've written...", "Here is...", "I've delivered...").
    3. Do NOT include ANY closing remarks (e.g., "I hope this helps", "Let me know...", "Would you like me to save...").
    4. Output ONLY the raw blog post Markdown. Nothing else.

  editor_instructions: |
    YOUR ROLE: Senior Content Editor

    EXPERTISE:
    - Technical accuracy
    - Readability and flow
    - SEO optimization
    - Copywriting best practices

    YOUR TASK:
    Edit the provided draft to improve:

    1. CLARITY
       - Simplify complex sentences
       - Remove jargon or explain it
       - Improve transitions between sections

    2. ENGAGEMENT
       - Strengthen the hook
       - Add storytelling elements
       - Improve call-to-action

    3. TECHNICAL ACCURACY
       - Verify code examples
       - Check for outdated information
       - Ensure best practices

    4. SEO
       - Optimize keyword density (1-2%)
       - Improve meta description potential
       - Add relevant LSI keywords

    5. WORD COUNT PRESERVATION
       - DO NOT expand the content beyond the word limit
       - If draft is over the limit, trim while keeping key points
       - Maintain conciseness and focus
       - Quality over quantity

    OUTPUT: Edited blog post in clean Markdown format.

    CRITICAL OUTPUT RULES:
    1. Start DIRECTLY with the blog post title (e.g., "# Title Here").
    2. Do NOT include ANY introductory text like "I've polished...", "Here is the edited version".
    3. Do NOT include ANY closing remarks or questions.
    4. Do NOT add separators like "---" before or after the content.
    5. Do NOT include HTML comments (<!-- -->) or any meta-commentary.
    6. Output ONLY the raw, clean blog post Markdown. Nothing else.

  reviewer_categories: |
    YOUR ROLE: Blog Post Quality Reviewer

    EVALUATION CRITERIA:

    Rate each category from 1-10 (where 8+ is publication-ready):

    1. STRUCTURE
       - Logical flow and organization
       - Clear heading hierarchy
       - Effective use of sections
       - Scannable layout

    2. GRAMMAR
       - Spelling and punctuation
       - Sentence structure
       - Readability (Flesch score 60+)
       - Consistent tense and voice

    3. TECHNICAL_ACCURACY
       - Correct facts and figures
       - Working code examples
       - Best practices followed
       - Current, not outdated

    4. ENGAGEMENT
       - Strong hook/opening
       - Compelling storytelling
       - Conversational tone
       - Reader-focused ("you" language)

    5. ACTIONABILITY
       - Practical takeaways
       - Clear next steps
       - Usable examples
       - Implementation guidance

    6. SEO
       - Target keyword optimization
       - Meta description potential
       - LSI keyword usage
       - Readability score

    7. FORMATTING
       - Markdown syntax correct
       - Code blocks properly tagged
       - Lists and emphasis used well
       - Visual hierarchy clear

    8. DEPTH
       - Comprehensive coverage
       - Multiple examples
       - Edge cases addressed
       - Beyond surface-level

    9. ORIGINALITY
       - Unique insights or perspective
       - Fresh examples
       - Not generic advice
       - Personal experience or research

    10. WORD_COUNT
       - Within specified min-max range
       - Not too short or padded
       - Appropriate for topic depth
       - USE EXACT WORD COUNT PROVIDED (do not estimate)

    11. TITLE
       - Power words (Ultimate, Essential, Proven, etc.)
       - Creates curiosity or urgency
       - Clear benefit promise
       - Under 70 characters
       - SEO-friendly

    12. INTRO
       - Strong hook (first 1-2 sentences)
       - AIDA structure (Attention, Interest, Desire, Action)
       - Pain point identification
       - "You" language (reader-focused)
       - Creates urgency or FOMO

    OUTPUT FORMAT (STRICT):

    STRUCTURE: [score] - [brief feedback]
    GRAMMAR: [score] - [brief feedback]
    TECHNICAL_ACCURACY: [score] - [brief feedback]
    ENGAGEMENT: [score] - [brief feedback]
    ACTIONABILITY: [score] - [brief feedback]
    SEO: [score] - [brief feedback]
    FORMATTING: [score] - [brief feedback]
    DEPTH: [score] - [brief feedback]
    ORIGINALITY: [score] - [brief feedback]
    WORD_COUNT: [score] - [brief feedback with exact word count and analysis]
    TITLE: [score] - [brief feedback]
    INTRO: [score] - [brief feedback]

    OVERALL_FEEDBACK: [2-3 sentence summary]

    APPROVAL STATUS: [APPROVED if all >= 8, else NEEDS_REVISION]

  revision_prompt: |
    ASSIGNMENT: Revise blog post based on reviewer feedback

    ORIGINAL DRAFT:
    {draft}

    REVIEWER FEEDBACK:
    {review}

    YOUR TASK:
    Address ALL feedback points to bring each category to 8+.

    FOCUS AREAS (from lowest scores):
    {focus_areas}

    OUTPUT: Fully revised blog post in Markdown.

    CRITICAL OUTPUT RULES:
    1. Start DIRECTLY with the blog post title (e.g., "# Title Here").
    2. Do NOT include ANY introductory text or meta-commentary.
    3. Do NOT include ANY closing remarks.
    4. Maintain word count between {min_words} and {max_words} words.
    5. Output ONLY the raw blog post Markdown. Nothing else.

  writer_human_revision: |
    HUMAN REVIEWER FEEDBACK:
    {user_feedback}

    PREVIOUS VERSION (in your session memory):
    Review your previous draft from this session.

    INSTRUCTIONS:
    1. Address the human feedback above by REVISING your previous draft.
    2. PRESERVE the existing content, structure, and key points.
    3. DO NOT rewrite from scratch - make targeted improvements only.
    4. If asked to shorten: TRIM content while keeping the best parts.
    5. If asked to expand: ADD detail to existing sections.
    6. Maintain word count between {min_words} and {max_words} words.

    COPYWRITING RULES:
    - Title: Use power words, create curiosity, promise clear benefit
    - Introduction: Hook immediately, identify pain points, follow AIDA principles

    CRITICAL OUTPUT RULES:
    - Start DIRECTLY with the blog post title (e.g., "# Title Here").
    - Do NOT include ANY introductory text.
    - Do NOT include ANY closing remarks.
    - Output ONLY the raw blog post Markdown.

  editor_initial: |
    {editor_instructions}

    WORD COUNT REQUIREMENT: Between {min_words} and {max_words} words.
    IMPORTANT: DO NOT expand content beyond {max_words} words. Trim if necessary.

    DRAFT TO EDIT:
    {draft}

  editor_subsequent: |
    NEW VERSION TO EDIT:
    {draft}

    EDITING TASKS:
    1. Apply consistent style based on your previous edits (in session memory).
    2. Fix any new grammar, spelling, and style issues.
    3. Improve clarity while PRESERVING the writer's key points.
    4. Ensure title and introduction follow copywriting best practices.
    5. MAINTAIN word count between {min_words} and {max_words} words.
    6. DO NOT expand beyond {max_words} words - trim if necessary.

    CRITICAL OUTPUT RULES:
    - Start DIRECTLY with the blog post title (e.g., "# Title Here").
    - Do NOT include ANY introductory text or meta-commentary.
    - Do NOT include ANY closing remarks.
    - Do NOT add separators like "---" before or after the content.
    - Output ONLY the raw blog post Markdown. Nothing else.

  reviewer_initial: |
    YOUR ROLE: Strict Blog Post Reviewer

    TASK: Evaluate the blog post quality.
    WORD COUNT REQUIREMENT: Between {min_words} and {max_words} words.
    ACTUAL CONTENT WORD COUNT: {content_words} words (measured, not estimated)

    IMPORTANT: You are a STRICT reviewer. Only give scores of 8+ if the content truly excels.
    The blog will ONLY pass to human review if ALL categories score 8 or higher.

    BLOG POST TO REVIEW:
    ---
    {content}
    ---

    {reviewer_categories}

    CRITICAL: Respond in EXACTLY this format (no markdown headers, no /10 suffixes):
    STRUCTURE: [score] - [brief feedback]
    GRAMMAR: [score] - [brief feedback]
    TECHNICAL_ACCURACY: [score] - [brief feedback]
    ENGAGEMENT: [score] - [brief feedback]
    ACTIONABILITY: [score] - [brief feedback]
    SEO: [score] - [brief feedback]
    FORMATTING: [score] - [brief feedback]
    DEPTH: [score] - [brief feedback]
    ORIGINALITY: [score] - [brief feedback]
    WORD_COUNT: [score] - [brief feedback with exact word count and analysis]
    TITLE: [score] - [brief feedback]
    INTRO: [score] - [brief feedback]

    OVERALL_FEEDBACK: [2-3 sentence summary with specific improvement suggestions or "Ready for publication"]

    APPROVAL_STATUS: [APPROVED if all categories >= 8, else NEEDS_REVISION]

  reviewer_subsequent: |
    NEW VERSION TO REVIEW (iteration {iteration}):
    ---
    {content}
    ---

    ACTUAL CONTENT WORD COUNT: {content_words} words (measured, not estimated)
    WORD COUNT REQUIREMENT: Between {min_words} and {max_words} words.

    Compare this to the previous version you reviewed (in your session memory).

    IMPORTANT: You are a STRICT reviewer. Only give scores of 8+ if content truly excels.
    The blog will ONLY pass if ALL categories score 8 or higher.

    {reviewer_categories}

    CRITICAL: Respond in EXACTLY this format (no markdown headers, no /10 suffixes):
    STRUCTURE: [score] - [brief feedback]
    GRAMMAR: [score] - [brief feedback]
    TECHNICAL_ACCURACY: [score] - [brief feedback]
    ENGAGEMENT: [score] - [brief feedback]
    ACTIONABILITY: [score] - [brief feedback]
    SEO: [score] - [brief feedback]
    FORMATTING: [score] - [brief feedback]
    DEPTH: [score] - [brief feedback]
    ORIGINALITY: [score] - [brief feedback]
    WORD_COUNT: [score] - [brief feedback with exact word count and analysis]
    TITLE: [score] - [brief feedback]
    INTRO: [score] - [brief feedback]

    OVERALL_FEEDBACK: [2-3 sentence summary]

    APPROVAL_STATUS: [APPROVED if all >= 8, else NEEDS_REVISION]

# =============================================================================
# Retry Configuration
# =============================================================================
retry:
  max_retries: 2
  # Strategy: "fresh_session" (first), "explicit_format" (second)
  strategies:
    - fresh_session
    - explicit_format

# =============================================================================
# Output Settings
# =============================================================================
output:
  # Output filename template (supports {topic} placeholder)
  filename_template: "{date}-blog-{topic}.md"
  # Save intermediate drafts for debugging
  save_drafts: false
  drafts_dir: ".drafts"
